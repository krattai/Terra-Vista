#VRML V2.0 utf8


PROTO Flag [
 exposedField  MFString Source " "
 exposedField  MFString Destination " "
 exposedField  SFString Descrip " "
 ]
 {
Anchor {
 url IS Destination
 description IS Descrip
 children [
DEF Flag_and_Pole Transform { # this Transform groups both the flag and pole together
        translation 0 0 0
        children [
        
        DEF Flag Transform {    # this is the "heart of the matter" - if you don't care for my
                                                        # most excellent flagpole ;-), just grab the "Flag Transform" and the "ROUTEs"
                translation 0 0 0
                rotation 0 1 0 -1.57
                scale .8 1 .66  # aproximates the dimensions of your jpg, regular flagsize would be: 1 1 1 
                                                # x will control 'wind' turbulence(higher the number, the more the flag
                                                # will flap)but also effects flag length, y is flag height, z is flag length
                children [
                Shape {
                        appearance
                        Appearance {
                                material
                                DEF Flag_Color Material {
                                        diffuseColor 0.58 0.68 0.68 # play with these, different browsers do different things
                                        emissiveColor .05 .06 .06
                                        #shininess 0
                                }
                                texture
                                DEF Flag_Texture ImageTexture {
                                            
                                        url IS Source
                                }
                        }
                        geometry
                        IndexedFaceSet {
                                coord
                                DEF FlagCoords Coordinate {
                                        point [
                                        0.00 0.78 -0.01 ,
                                        -0.39 0.78 -2.29 ,
                                        -0.39 -0.71 -2.29 ,
                                        0.00 -0.71 -0.01 ,
                                        -0.10 0.78 -2.01 ,
                                        0.14 0.78 -1.72 ,
                                        0.22 0.78 -1.44 ,
                                        0.16 0.78 -1.15 ,
                                        0.07 0.78 -0.87 ,
                                        0.01 0.78 -0.58 ,
                                        0 0.78 -0.30 ,
                                        0 -0.71 -0.30 ,
                                        0.01 -0.71 -0.58 ,
                                        0.07 -0.71 -0.87 ,
                                        0.16 -0.71 -1.15 ,
                                        0.22 -0.71 -1.44 ,
                                        0.14 -0.71 -1.72 ,
                                        -0.10 -0.71 -2.01 ,
                                        -0.26 0.78 -2.16 ,
                                        0.02 0.78 -1.87 ,
                                        0.20 0.78 -1.59 ,
                                        0.21 0.78 -1.30 ,
                                        0.12 0.78 -1.02 ,
                                        0.03 0.78 -0.73 ,
                                        0.00 0.78 -0.45 ,
                                        0 0.78 -0.16 ,
                                        0 -0.71 -0.16 ,
                                        0.00 -0.71 -0.45 ,
                                        0.03 -0.71 -0.73 ,
                                        0.12 -0.71 -1.02 ,
                                        0.21 -0.71 -1.30 ,
                                        0.20 -0.71 -1.59 ,
                                        0.02 -0.71 -1.87 ,
                                        -0.26 -0.71 -2.16
                                        ]
                                }
                                texCoord
                                TextureCoordinate {
                                        point [ 1 0 ,
                                        0.93 0 ,
                                        1 1 ,
                                        0.93 1 ,
                                        0.86 0 ,
                                        0.86 1 ,
                                        0.80 0 ,
                                        0.80 1 ,
                                        0.73 0 ,
                                        0.73 1 ,
                                        0.68 0 ,
                                        0.68 1 ,
                                        0.61 0 ,
                                        0.61 1 ,
                                        0.55 0 ,
                                        0.55 1 ,
                                        0.49 0 ,
                                        0.49 1 ,
                                        0.43 0 ,
                                        0.43 1 ,
                                        0.37 0 ,
                                        0.37 1 ,
                                        0.31 0 ,
                                        0.31 1 ,
                                        0.24 0 ,
                                        0.24 1 ,
                                        0.19 0 ,
                                        0.19 1 ,
                                        0.12 0 ,
                                        0.12 1 ,
                                        0.06 0 ,
                                        0.06 1 ,
                                        0 0 ,
                                        0 1 ]
                                }
                                ccw FALSE
                                solid FALSE
                                convex FALSE
                                creaseAngle 1.57
                                coordIndex [ 2 , 33 , 1 , -1 , 33 , 18 , 1 , -1 ,
                                33 , 17 , 18 , -1 , 17 , 4 , 18 , -1 ,
                                17 , 32 , 4 , -1 , 32 , 19 , 4 , -1 ,
                                32 , 16 , 19 , -1 , 16 , 5 , 19 , -1 ,
                                16 , 31 , 5 , -1 , 31 , 20 , 5 , -1 ,
                                31 , 15 , 20 , -1 , 15 , 6 , 20 , -1 ,
                                15 , 30 , 6 , -1 , 30 , 21 , 6 , -1 ,
                                30 , 14 , 21 , -1 , 14 , 7 , 21 , -1 ,
                                14 , 29 , 7 , -1 , 29 , 22 , 7 , -1 ,
                                29 , 13 , 22 , -1 , 13 , 8 , 22 , -1 ,
                                13 , 28 , 8 , -1 , 28 , 23 , 8 , -1 ,
                                28 , 12 , 23 , -1 , 12 , 9 , 23 , -1 ,
                                12 , 27 , 9 , -1 , 27 , 24 , 9 , -1 ,
                                27 , 11 , 24 , -1 , 11 , 10 , 24 , -1 ,
                                11 , 26 , 10 , -1 , 26 , 25 , 10 , -1 ,
                                3 , 25 , 26 , -1 , 25 , 3 , 0 , -1 ,
                                1 , 33 , 2 , -1 , 1 , 18 , 33 , -1 ,
                                18 , 17 , 33 , -1 , 18 , 4 , 17 , -1 ,
                                4 , 32 , 17 , -1 , 4 , 19 , 32 , -1 ,
                                19 , 16 , 32 , -1 , 19 , 5 , 16 , -1 ,
                                5 , 31 , 16 , -1 , 5 , 20 , 31 , -1 ,
                                20 , 15 , 31 , -1 , 20 , 6 , 15 , -1 ,
                                6 , 30 , 15 , -1 , 6 , 21 , 30 , -1 ,
                                21 , 14 , 30 , -1 , 21 , 7 , 14 , -1 ,
                                7 , 29 , 14 , -1 , 7 , 22 , 29 , -1 ,
                                22 , 13 , 29 , -1 , 22 , 8 , 13 , -1 ,
                                8 , 28 , 13 , -1 , 8 , 23 , 28 , -1 ,
                                23 , 12 , 28 , -1 , 23 , 9 , 12 , -1 ,
                                9 , 27 , 12 , -1 , 9 , 24 , 27 , -1 ,
                                24 , 11 , 27 , -1 , 24 , 10 , 11 , -1 ,
                                10 , 26 , 11 , -1 , 10 , 25 , 26 , -1 ,
                                26 , 25 , 3 , -1 , 0 , 3 , 25 , -1 ]
                                
                                texCoordIndex [ 0 , 1 , 2 , -1 , 1 , 3 , 2 , -1 ,
                                1 , 4 , 3 , -1 , 4 , 5 , 3 , -1 ,
                                4 , 6 , 5 , -1 , 6 , 7 , 5 , -1 ,
                                6 , 8 , 7 , -1 , 8 , 9 , 7 , -1 ,
                                8 , 10 , 9 , -1 , 10 , 11 , 9 , -1 ,
                                10 , 12 , 11 , -1 , 12 , 13 , 11 , -1 ,
                                12 , 14 , 13 , -1 , 14 , 15 , 13 , -1 ,
                                14 , 16 , 15 , -1 , 16 , 17 , 15 , -1 ,
                                16 , 18 , 17 , -1 , 18 , 19 , 17 , -1 ,
                                18 , 20 , 19 , -1 , 20 , 21 , 19 , -1 ,
                                20 , 22 , 21 , -1 , 22 , 23 , 21 , -1 ,
                                22 , 24 , 23 , -1 , 24 , 25 , 23 , -1 ,
                                24 , 26 , 25 , -1 , 26 , 27 , 25 , -1 ,
                                26 , 28 , 27 , -1 , 28 , 29 , 27 , -1 ,
                                28 , 30 , 29 , -1 , 30 , 31 , 29 , -1 ,
                                32 , 31 , 30 , -1 , 31 , 32 , 33 , -1 ,
                                2 , 1 , 0 , -1 , 2 , 3 , 1 , -1 ,
                                3 , 4 , 1 , -1 , 3 , 5 , 4 , -1 ,
                                5 , 6 , 4 , -1 , 5 , 7 , 6 , -1 ,
                                7 , 8 , 6 , -1 , 7 , 9 , 8 , -1 ,
                                9 , 10 , 8 , -1 , 9 , 11 , 10 , -1 ,
                                11 , 12 , 10 , -1 , 11 , 13 , 12 , -1 ,
                                13 , 14 , 12 , -1 , 13 , 15 , 14 , -1 ,
                                15 , 16 , 14 , -1 , 15 , 17 , 16 , -1 ,
                                17 , 18 , 16 , -1 , 17 , 19 , 18 , -1 ,
                                19 , 20 , 18 , -1 , 19 , 21 , 20 , -1 ,
                                21 , 22 , 20 , -1 , 21 , 23 , 22 , -1 ,
                                23 , 24 , 22 , -1 , 23 , 25 , 24 , -1 ,
                                25 , 26 , 24 , -1 , 25 , 27 , 26 , -1 ,
                                27 , 28 , 26 , -1 , 27 , 29 , 28 , -1 ,
                                29 , 30 , 28 , -1 , 29 , 31 , 30 , -1 ,
                                30 , 31 , 32 , -1 , 33 , 32 , 31 , -1 ]
                                
                        }
                },
               
                DEF Clock TimeSensor {
                        loop TRUE
                        enabled FALSE
                },
                  DEF See VisibilitySensor { 
            size 3 3 3 
            enabled TRUE
            size  3 10 3   
                 },                                                                      

            

                                                       
                DEF FlagMorph CoordinateInterpolator {  # six frames of point animation (yes, I used a modeler ;-)
                                                                                                # I'd rather use a "Script" generating a sine wave, but browsers are too "Script-finicky" right now
                        key [ 0 , 0.2 , 0.4 , 0.6 , 0.8 , 1 ]
                        keyValue [
                        # frame 1
                        0.00 0.78 -0.01 ,
                        -0.39 0.78 -2.29 ,
                        -0.39 -0.71 -2.29 ,
                        0.00 -0.71 -0.01 ,
                        -0.10 0.78 -2.01 ,
                        0.14 0.78 -1.72 ,
                        0.22 0.78 -1.44 ,
                        0.16 0.78 -1.15 ,
                        0.07 0.78 -0.87 ,
                        0.01 0.78 -0.58 ,
                        0 0.78 -0.30 ,
                        0 -0.71 -0.30 ,
                        0.01 -0.71 -0.58 ,
                        0.07 -0.71 -0.87 ,
                        0.16 -0.71 -1.15 ,
                        0.22 -0.71 -1.44 ,
                        0.14 -0.71 -1.72 ,
                        -0.10 -0.71 -2.01 ,
                        -0.26 0.78 -2.16 ,
                        0.02 0.78 -1.87 ,
                        0.20 0.78 -1.59 ,
                        0.21 0.78 -1.30 ,
                        0.12 0.78 -1.02 ,
                        0.03 0.78 -0.73 ,
                        0.00 0.78 -0.45 ,
                        0 0.78 -0.16 ,
                        0 -0.71 -0.16 ,
                        0.00 -0.71 -0.45 ,
                        0.03 -0.71 -0.73 ,
                        0.12 -0.71 -1.02 ,
                        0.21 -0.71 -1.30 ,
                        0.20 -0.71 -1.59 ,
                        0.02 -0.71 -1.87 ,
                        -0.26 -0.71 -2.16 ,
                        # frame 2
                        0.00 0.78 -0.01 ,
                        -0.07 0.78 -2.29 ,
                        -0.07 -0.71 -2.29 ,
                        0.00 -0.71 -0.01 ,
                        0.24 0.78 -2.01 ,
                        0.36 0.78 -1.72 ,
                        0.28 0.78 -1.44 ,
                        0.13 0.78 -1.15 ,
                        0.02 0.78 -0.87 ,
                        -0.00 0.78 -0.58 ,
                        0.00 0.78 -0.30 ,
                        0.00 -0.71 -0.30 ,
                        -0.00 -0.71 -0.58 ,
                        0.02 -0.71 -0.87 ,
                        0.13 -0.71 -1.15 ,
                        0.28 -0.71 -1.44 ,
                        0.36 -0.71 -1.72 ,
                        0.24 -0.71 -2.01 ,
                        0.09 0.78 -2.16 ,
                        0.33 0.78 -1.87 ,
                        0.34 0.78 -1.59 ,
                        0.21 0.78 -1.30 ,
                        0.07 0.78 -1.02 ,
                        0.00 0.78 -0.73 ,
                        0 0.78 -0.45 ,
                        0.00 0.78 -0.16 ,
                        0.00 -0.71 -0.16 ,
                        0 -0.71 -0.45 ,
                        0.00 -0.71 -0.73 ,
                        0.07 -0.71 -1.02 ,
                        0.21 -0.71 -1.30 ,
                        0.34 -0.71 -1.59 ,
                        0.33 -0.71 -1.87 ,
                        0.09 -0.71 -2.16 ,
                        # frame 3
                        0.01 0.78 -0.01 ,
                        0.38 0.78 -2.29 ,
                        0.38 -0.71 -2.29 ,
                        0.01 -0.71 -0.01 ,
                        0.52 0.78 -2.01 ,
                        0.41 0.78 -1.72 ,
                        0.20 0.78 -1.44 ,
                        0.03 0.78 -1.15 ,
                        -0.00 0.78 -0.87 ,
                        0.01 0.78 -0.58 ,
                        0.02 0.78 -0.30 ,
                        0.02 -0.71 -0.30 ,
                        0.01 -0.71 -0.58 ,
                        -0.00 -0.71 -0.87 ,
                        0.03 -0.71 -1.15 ,
                        0.20 -0.71 -1.44 ,
                        0.41 -0.71 -1.72 ,
                        0.52 -0.71 -2.01 ,
                        0.48 0.78 -2.16 ,
                        0.50 0.78 -1.87 ,
                        0.31 0.78 -1.59 ,
                        0.11 0.78 -1.30 ,
                        0.00 0.78 -1.02 ,
                        -0.00 0.78 -0.73 ,
                        0.02 0.78 -0.45 ,
                        0.02 0.78 -0.16 ,
                        0.02 -0.71 -0.16 ,
                        0.02 -0.71 -0.45 ,
                        -0.00 -0.71 -0.73 ,
                        0.00 -0.71 -1.02 ,
                        0.11 -0.71 -1.30 ,
                        0.31 -0.71 -1.59 ,
                        0.50 -0.71 -1.87 ,
                        0.48 -0.71 -2.16 ,
                        # frame 4
                        0.01 0.78 -0.01 ,
                        0.70 0.78 -2.29 ,
                        0.70 -0.71 -2.29 ,
                        0.01 -0.71 -0.01 ,
                        0.55 0.78 -2.01 ,
                        0.26 0.78 -1.72 ,
                        0.04 0.78 -1.44 ,
                        -0.02 0.78 -1.15 ,
                        0.01 0.78 -0.87 ,
                        0.04 0.78 -0.58 ,
                        0.04 0.78 -0.30 ,
                        0.04 -0.71 -0.30 ,
                        0.04 -0.71 -0.58 ,
                        0.01 -0.71 -0.87 ,
                        -0.02 -0.71 -1.15 ,
                        0.04 -0.71 -1.44 ,
                        0.26 -0.71 -1.72 ,
                        0.55 -0.71 -2.01 ,
                        0.66 0.78 -2.16 ,
                        0.42 0.78 -1.87 ,
                        0.14 0.78 -1.59 ,
                        -0.00 0.78 -1.30 ,
                        -0.01 0.78 -1.02 ,
                        0.03 0.78 -0.73 ,
                        0.05 0.78 -0.45 ,
                        0.02 0.78 -0.16 ,
                        0.02 -0.71 -0.16 ,
                        0.05 -0.71 -0.45 ,
                        0.03 -0.71 -0.73 ,
                        -0.01 -0.71 -1.02 ,
                        -0.00 -0.71 -1.30 ,
                        0.14 -0.71 -1.59 ,
                        0.42 -0.71 -1.87 ,
                        0.66 -0.71 -2.16 ,
                        # frame 5
                        -0.00 0.78 -0.01 ,
                        0.68 0.78 -2.29 ,
                        0.68 -0.71 -2.29 ,
                        -0.00 -0.71 -0.01 ,
                        0.32 0.78 -2.01 ,
                        0.03 0.78 -1.72 ,
                        -0.05 0.78 -1.44 ,
                        0.00 0.78 -1.15 ,
                        0.07 0.78 -0.87 ,
                        0.07 0.78 -0.58 ,
                        0.02 0.78 -0.30 ,
                        0.02 -0.71 -0.30 ,
                        0.07 -0.71 -0.58 ,
                        0.07 -0.71 -0.87 ,
                        0.00 -0.71 -1.15 ,
                        -0.05 -0.71 -1.44 ,
                        0.03 -0.71 -1.72 ,
                        0.32 -0.71 -2.01 ,
                        0.52 0.78 -2.16 ,
                        0.16 0.78 -1.87 ,
                        -0.03 0.78 -1.59 ,
                        -0.03 0.78 -1.30 ,
                        0.04 0.78 -1.02 ,
                        0.08 0.78 -0.73 ,
                        0.05 0.78 -0.45 ,
                        0.00 0.78 -0.16 ,
                        0.00 -0.71 -0.16 ,
                        0.05 -0.71 -0.45 ,
                        0.08 -0.71 -0.73 ,
                        0.04 -0.71 -1.02 ,
                        -0.03 -0.71 -1.30 ,
                        -0.03 -0.71 -1.59 ,
                        0.16 -0.71 -1.87 ,
                        0.52 -0.71 -2.16 ,
                        # frame 6
                        -0.02 0.78 -0.01 ,
                        0.35 0.78 -2.29 ,
                        0.35 -0.71 -2.29 ,
                        -0.02 -0.71 -0.01 ,
                        0.00 0.78 -2.01 ,
                        -0.09 0.78 -1.72 ,
                        -0.01 0.78 -1.44 ,
                        0.09 0.78 -1.15 ,
                        0.10 0.78 -0.87 ,
                        0.04 0.78 -0.58 ,
                        -0.02 0.78 -0.30 ,
                        -0.02 -0.71 -0.30 ,
                        0.04 -0.71 -0.58 ,
                        0.10 -0.71 -0.87 ,
                        0.09 -0.71 -1.15 ,
                        -0.01 -0.71 -1.44 ,
                        -0.09 -0.71 -1.72 ,
                        0.00 -0.71 -2.01 ,
                        0.16 0.78 -2.16 ,
                        -0.07 0.78 -1.87 ,
                        -0.07 0.78 -1.59 ,
                        0.03 0.78 -1.30 ,
                        0.11 0.78 -1.02 ,
                        0.08 0.78 -0.73 ,
                        0.00 0.78 -0.45 ,
                        -0.03 0.78 -0.16 ,
                        -0.03 -0.71 -0.16 ,
                        0.00 -0.71 -0.45 ,
                        0.08 -0.71 -0.73 ,
                        0.11 -0.71 -1.02 ,
                        0.03 -0.71 -1.30 ,
                        -0.07 -0.71 -1.59 ,
                        -0.07 -0.71 -1.87 ,
                        0.16 -0.71 -2.16
                        ]
                },
                ]
        }, #end Flag
 ]
 }         
        
        DEF FlagPole Transform {
                translation -0.07 1 0 # relative to Flag if grouped with it
                children [
                Group {
                        children [
                        DEF Pole_Top Transform {
                                scale 0.12 0.12 0.12
                                children [
                                Shape {
                                        appearance
                                        Appearance {
                                                material
                                                DEF Pole_Color Material { # Shiny White Metal(change to your choice)
                                                        diffuseColor 0.62 0.62 0.62
                                                        shininess 1
                                                        transparency 0
                                                }
                                        }
                                        geometry
                                        Sphere {}
                                        }
                                        ]
                                },
                                DEF Pole_Shaft Transform {
                                        translation 0 -3.98 0 # bring it down to ground level before scaling up
                                        scale 0.06 3.97 0.06
                                        children [
                                        Shape {
                                                appearance
                                                Appearance {
                                                        material
                                                        USE Pole_Color
                                                }
                                                geometry
                                                Cylinder {}
                                                }
                                                ]
                                        }
                                        ]
                                }
                                ]
                        }, #end FlagPole
                        ]
                } #end Flag_and_Pole
                
                # Need these ROUTEs with "Flag Transform" to make it all happen
                USE Clock              
                ROUTE See.isActive TO Clock.set_enabled   
                ROUTE Clock.fraction_changed TO FlagMorph.set_fraction
                ROUTE FlagMorph.value_changed TO FlagCoords.set_point
    WorldInfo {
        title "Joel's Morphing VRMLFlag for vCity"
        info [
        "(c) Copyright 1997 , Joel Tanis, PointLight Graphics and Internet Design"
        " Originally created for Adam L. Gruen's 'vCity 1.0' Webwork, http://www.well.com/user/adamgru"
        ]
},            
 }               
                        
                        
